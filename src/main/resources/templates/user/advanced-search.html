<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Advanced Search</title>
    <link rel="stylesheet" th:href="@{/user/assets/css/style.css}">
</head>
<body>
    <div class="container">
        <h1>Advanced Search</h1>
        
        <!-- Search Form -->
        <form th:action="@{/user/advanced-search}" method="get">
            <div class="form-group">
                <label for="query">Search Query:</label>
                <input type="text" id="query" name="query" th:value="${param.query}">
            </div>
            
            <div class="form-group">
                <label for="brand">Brand:</label>
                <select id="brand" name="brand">
                    <option value="">All Brands</option>
                    <option th:each="brand : ${brands}" 
                            th:value="${brand.name}"
                            th:text="${brand.name}"
                            th:selected="${param.brand != null and param.brand[0] == brand.name}">
                    </option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="category">Category:</label>
                <select id="category" name="category">
                    <option value="">All Categories</option>
                    <option th:each="category : ${categories}"
                            th:value="${category.name}"
                            th:text="${category.name}"
                            th:selected="${param.category != null and param.category[0] == category.name}">
                    </option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="sort">Sort By:</label>
                <select id="sort" name="sort">
                    <option value="">Default</option>
                    <option value="price_asc" th:selected="${param.sort != null and param.sort[0] == 'price_asc'}">Price: Low to High</option>
                    <option value="price_desc" th:selected="${param.sort != null and param.sort[0] == 'price_desc'}">Price: High to Low</option>
                    <option value="name_asc" th:selected="${param.sort != null and param.sort[0] == 'name_asc'}">Name: A to Z</option>
                    <option value="name_desc" th:selected="${param.sort != null and param.sort[0] == 'name_desc'}">Name: Z to A</option>
                </select>
            </div>
            
            <button type="submit">Search</button>
        </form>

        <!-- Error Message -->
        <div th:if="${error}" class="error-message" th:text="${error}"></div>

        <!-- Flag Display -->
        <div th:if="${flag}" class="flag-display">
            <h2>Congratulations! You found the flag:</h2>
            <p th:text="${flag}"></p>
        </div>

        <!-- Search Results -->
        <div th:if="${products != null and !products.empty}" class="search-results">
            <h2>Search Results</h2>
            <div class="product-grid">
                <div th:each="product : ${products}" class="product-card">
                    <img th:src="${product.image_url}" alt="Product Image">
                    <h3 th:text="${product.name}"></h3>
                    <p class="price" th:text="${#numbers.formatCurrency(product.price)}"></p>
                    <p class="brand" th:text="${product.brand_name}"></p>
                    <p class="category" th:text="${product.category_name}"></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 